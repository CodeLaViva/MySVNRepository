# task问题

Q： 工作中为什么会产生版本冲突，版本冲突如何解决

A：

* 为什么会产生：在团队合作过程中，大家共同使用一个仓库获取工作文件，当A和B同时提取了库内文件 File1 时，A对 File1 文件修改完成后进行commit操作（记FileA）。此时B也对 File1 文件进行修改，但是当B进行 commit 时，此时版本控制工具会进行检查，发现如果此时 B将他的 FileB进行commit，会对A的修改进行覆盖操作，此时就产生了版本冲突。
* 如何解决：
    1. 解锁-修改-释放：这种方法是通过对当前工作文件进行标记（加锁）实现版本控制。A 在库中提取了文件 File1，同时对 File1 添加标记，表示正在被使用，此时 B无法从库中提取 File1，必须等待 A修改好 File1，并且提交到库，释放标记后才能进行操作。但是这种方法存在严重的问题，使用这种模式在大规模团队作业中，会大大降低工作效率，并且这种方式也不能保证 A 修改后的文件被 B提取后，B 不会覆盖掉 A修改的内容。
    2. 拷贝-提交-合并：这种方法是通过在 commit时进行版本比对实现版本控制。A在库中 update 了 File1，此时库中FIle1文件的基版本为1，同时B也 update了基版本为1的File1文件。A对FIle1文件进行修改后，执行commit操作，此时库文件更新为 FileA，版本为2。这时B也修改完成，进行commit操作，由于FileB文件的基版本为1，此时库中文件基版本为2，B的 commit操作失败，需要先进行update获取最新的基版本文件，在此基础上将自己的修改进行合并，再进行commit操作，此时库才能进行更新，库文件更新为FileB，版本为3。当然这种方法能够解决解锁-修改-释放的工作效率低下问题，但是还是无法保证，在B update FileA后对该文件进行修改等操作后，不会覆盖掉A的操作。所以需要工具的辅助。

工具辅助：B 在 commit失败后，会提示 B 进行update将本地文件更新到库基版本，B 进行 update操作会出现 conflict状态，并且自动生成相关文件，使用 diff来解决冲突（最好通过 A,B 协商方式进行 merge操作，避免覆盖操作）。冲突解决后执行 resolve，将生成的文件清理干净，B 再进行 commit更新到库。

Q： 对于跨地域协同开发的思考

A： 跨地域协同开发使用的版本控制工具推荐是用 Git而不是 SVN。

![Git主要特性](http://upload-images.jianshu.io/upload_images/5609636-b4bf195a2571abca?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

Git的版本控制模式更加灵活。当项目成立后，首先创建原始仓库，每个开发组将原始仓库 clone到本地，然后再checkout出小组的分支。开发过程中各地开发小组互不干扰、互不影响。开发完成后通过 add和 commit指令将个人代码汇集到本地仓库中，进行初次提交测试。测试通过后负责人对本地仓库执行 push 将代码推送到原始仓库请求 merge，如果提交测试通过就合并至原始仓库，否则退回提交申请，本地开发组做出相应修改再进行提交。

通过这种方式能够解决跨地域开发中的离线开发问题，并且使用这种方式也能够强化代码质量和编码协同的问题，安全性也相对来说提高了许多。本地库拥有本地开发的各个版本，方便出问题回滚。原始仓库也有各个小组开发的记录，也能够在出问题后进行回滚操作。